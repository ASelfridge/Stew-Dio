<!DOCTYPE html>

<html>
    <head>
        <title>Starting Environment</title>
         
        <script src="js/aframe-v0.8.2.min.js"></script>
		<script src="https://rawgit.com/Ctrl-Alt-Zen/aframe-mobile-controls/master/components/twoway-motion/twoway-motion.js"></script>
    	<script src="https://rawgit.com/Ctrl-Alt-Zen/aframe-mobile-controls/master/components/tilt-turn/tilt-turn.js"></script>
        <script src="https://rawgit.com/fernandojsg/aframe-teleport-controls/master/dist/aframe-teleport-controls.min.js"></script>
        <script src="js/object-pickup.js"></script>
        <script src="js/object-place.js"></script>
        <script src="js/new-recipe.js"></script>
        <script src="js/tool-component.js"></script>
        <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.3.0/dist/aframe-physics-system.min.js"></script>

        <script>
            AFRAME.registerComponent('loadscripts', {
                init: function()
                {
                   // Add scripts to the 'scriptSrc' list below so they are loaded after the scene is created!
                    scriptSrc = ["js/deviceControls.js"];
                    var head= document.getElementsByTagName('head')[0];
                    for (var i = 0; i < scriptSrc.length; i++) {
                        newScript = document.createElement('script');
                        newScript.setAttribute('src', scriptSrc[i]);
                        head.appendChild(newScript);
                        console.log(scriptSrc[i]);
                    };

                    //Playing background track
                    bgSound = document.querySelector('#ambiance');
                    bgSound.components['sound'].playSound();
                    bgMusic = document.querySelector('#music');
                    bgMusic.components['sound'].playSound();

                    customerBell = document.querySelector('#customerStation');
                    document.addEventListener('keydown', function(e) {
                        if(e.keyCode == 32) {
                            customerBell.components['sound'].stopSound();
                            customerBell.components['sound'].playSound();
                        }
                    });
                }
            });
            
        </script>
    </head>
    <body>
        <a-scene>
            
            <!-------------- TEXTURES ---------------->
            <a-assets>
                <img id="skymap" src="assets/textures/sunsetGradient.png" />

            </a-assets>


             <!-------------- SOUNDS ---------------->
             <a-assets>
                <a-asset-item crossorigin="anonymous" id="ambianceSrc" src="assets/sounds/stewIt_ambience.mp3" response-type="arraybuffer"></a-asset-item>
                <a-asset-item crossorigin="anonymous" id="musicSrc" src="assets/sounds/Whimsical-Popsicle.mp3" response-type="arraybuffer"></a-asset-item>
                <a-asset-item crossorigin="anonymous" id="customerBellSrc" src="assets/sounds/customer-bell.mp3" response-type="arraybuffer"></a-asset-item>
                <a-asset-item crossorigin="anonymous" id="customerGreetingSrc" src="assets/sounds/customer-hello.wav" response-type="arraybuffer"></a-asset-item>
            </a-assets>
                


            <!---------------- MODELS ---------------->
            <a-assets>
                <a-asset-item id="carrot_model" src="assets/models/carrot.obj"></a-asset-item>
                <a-asset-item id="table_model" src="assets/models/table.obj"></a-asset-item>
                <a-asset-item id="knife_model" src="assets/models/knife.obj"></a-asset-item>
                <a-asset-item id="cuttingBoard_model" src="assets/models/cuttingBoard.obj"></a-asset-item>
                <a-asset-item id="customerService_model" src="assets/models/customerService.obj"></a-asset-item>
                <a-asset-item id="ingredientStation_model" src="assets/models/ingredientStation.obj"></a-asset-item>
                <a-asset-item id="ladle_model" src="assets/models/ladle.obj"></a-asset-item>
                <a-asset-item id="pot_model" src="assets/models/pot.obj"></a-asset-item>
                <a-asset-item id="recipeBook_model" src="assets/models/recipeBook.obj"></a-asset-item>
                <a-asset-item id="stove_model" src="assets/models/stove.obj"></a-asset-item>
                <a-asset-item id="character_model" src="assets/models/character.obj"></a-asset-item>
                <a-asset-item id="bowl_model" src="assets/models/bowl.obj"></a-asset-item>
                <a-asset-item id="interactableIngredient_model" src="assets/models/ingredient.obj"></a-asset-item>
                <a-asset-item id="fryingPan_model" src="assets/models/fryingPan.obj"></a-asset-item>
            </a-assets>


            <!---------------- CAMERA ---------------->
           <a-entity id="cameraRig" position="0 1.9 3" rotation="0 180 0">
                <a-camera id="sceneCamera">
                    <a-entity id="cursor" cursor="rayOrigin: mouse" position="0 0 -1">
                    </a-entity>
                </a-camera>
            </a-entity>

    
            <!---------------- LIGHTING ---------------->
            <a-light type="directional" color="#FFBE92" position="35 17.746 -0.69474" intensity="0.5" scale="" light="castShadow:true;shadowCameraFov:60;shadowCameraLeft:-14.07;shadowCameraNear:0;shadowMapHeight:2048;shadowMapWidth:2048"></a-light>            
            <a-light type="ambient" color="white" position="35 5 0" intensity="0.4"></a-light>


            <!---------------- A-FRAME ENTITIES ---------------->


            <!-- SOUNDS ENTITIES -->
            <a-entity id="music" sound="src:#musicSrc; volume: 0.02; loop: true; positional:false" ></a-entity>
            <a-entity id="ambiance" sound="src:#ambianceSrc; volume: 0.06; loop: true; positional:false"></a-entity>


            <!-- CUSTOMER SERVICE -->
            <a-entity id="customerStation" obj-model="obj:#customerService_model" position="-0.00961 0 -0.85382" rotation="" scale="" shadow="" sound="src:#customerBellSrc">
            </a-entity>

            <a-entity new-recipe id="character" obj-model="obj:#character_model" position="-0.00961 -0.01024 -2.69885" rotation="0 -82.328305582348 0" scale="" shadow="" sound="src: #customerGreetingSrc">
            </a-entity>

            <a-plane static-body id="ingredientStationCollisionPlane" position="-0.052 1.900 -0.942" width="1" height="1" rotation="-90 0 0" color="#a5a5a5" scale="2.380 1.8 3.2" shadow></a-plane>



            <!-- INGREDIENT STATION-->
            <a-entity id="ingredientStation" static-body obj-model="obj:#ingredientStation_model" position="-3.828 0 11.265" rotation="0 324 0" scale="" shadow="">
            </a-entity>

            <a-entity id="interactableIngredient" dynamic-body object-pickup="position: 0.006 -0 -0.156; rotation: 0 0 0" obj-model="obj:#interactableIngredient_model" material="color: #477725" position="-2.509 2.021 11.445" rotation="0 0 0" scale="" shadow=""> 
            </a-entity>

            <a-entity object-place="hasCollision: true" id="interactableIngredient_placeholder" class="interactableIngredient_placeholder" obj-model="obj:#interactableIngredient_model" visible="false" material="color: red; opacity: 0.2;" position="5.562 3 4.863"  rotation="0 0 0" scale="" shadow="cast:false">
            </a-entity>


            <!-- this is the second red placement indicator for the stew  -->
                <a-entity object-place="hasCollision: true" id="interactableIngredient_placeholder2" class="interactableIngredient_placeholder" obj-model="obj:#interactableIngredient_model" visible="false" material="color: red; opacity: 0.2;" position="-0.883 3 5.748"  rotation="0 0 0" scale="" shadow="cast:false">
            </a-entity>

            <!-- PREPERATION STATION-->
            <a-entity id="prepStation" rotation="0 -232.21 0" position="3.27091 0 10.51185"> 

                    <a-entity obj-model="obj:#table_model" position="-1 -0.1 0" rotation="0 90 0" scale="" shadow="">
                    </a-entity>
                    
                    <!-- CUTTING BOARD AREA -->
                    <a-entity rotation="0 90 0" position="-1.13659 0.39414 -0.46369"> 
    
                        <a-entity obj-model="obj:#cuttingBoard_model" position="-0.55 1.414 0.3" rotation="" scale="0.7 0.7 0.7" shadow="">
                        </a-entity>
                        <a-entity 
                            id="knife" 
                            obj-model="obj:#knife_model" 
                            position="-0.198 1.481 0.2" 
                            rotation="-3.2 19.9 90" 
                            scale="1.5 1.5 1.5" 
                            material="color: #477725" 
                            shadow=""
                            
                            tool
                            object-pickup="position: 0.755 -0.871 -0.357; rotation: 40 20 190" 
                            >
                        </a-entity>
                        <a-entity id="knife_placeholder" object-place  class="knife_placeholder" visible="false" obj-model="obj:#knife_model" material="color: red; opacity: 0.2;" position="-0.198 1.481 0.2" rotation="-3.2 19.9 90" scale="1.5 1.5 1.5" shadow="">
                        </a-entity>

                        <a-plane static-body id="knifeCollisionPlane" position="-0.436 1.35 0.329" width="1" height="1" scale="1 0.64 1" rotation="-90 0 0" color="#a5a5a5" shadow></a-plane>
        
                    </a-entity>
                        
                </a-entity>

            <!-- COOKING AREA -->
            <a-entity id="cookingStation" rotation="0 107.58 0" position="6.08818 0 4.25484"> 

                    <a-entity static-body obj-model="obj:#table_model" position="" rotation="" scale="" shadow="">
                    </a-entity>
    
                    <a-entity id="stove" obj-model="obj:#stove_model" position="0.04297 -0.34832 -0.16904" rotation="0 180 0" scale="0.8 0.8 0.8" shadow="">
                    </a-entity>

                    <a-entity id="fryingPan" obj-model="obj:#fryingPan_model" position="-0.356 2.004 -0.561" rotation="0 180 0" scale="0.5 0.5 0.5" shadow="">
                    </a-entity>

                    <a-plane static-body id="fryingPanCollisionPlane" position="-0.356 1.9 -0.561" width="1" height="1" rotation="-90 0 0" color="#a5a5a5" shadow></a-plane>

            </a-entity>
            

            <!-- RECIPIE AREA -->
            <a-entity id="recipeStation" rotation="0 72 0" position="-6.58179 0 4.18675"> 

                    <a-entity obj-model="obj:#table_model" position="" rotation="" scale="" shadow="">
                    </a-entity>
    
                    <a-entity obj-model="obj:#recipeBook_model" position="-0.07552 1.82164 0.12949" rotation="" scale="0.8 0.8 0.8" shadow="">
                    </a-entity>
    
            </a-entity>

            <!-- STEW AREA -->
            <a-entity id="stewStation" rotation="0 -30 0" position="0 0 6">

                <a-entity obj-model="obj:#table_model" position="0.66201 0 -0.81071" rotation="0 -55.75395008638529 0" scale="0.41442 0.81438 0.5" shadow="">
                </a-entity>

                <a-entity obj-model="obj:#pot_model" position="-0.77368 -0.1 0.25715" rotation="0 90 0" scale="0.8 0.8 0.8" shadow="">
                </a-entity>
    
                <a-entity object-pickup="position: 0.826 -1.509 -0.711; rotation: -30 180 -8.6" id="ladle" obj-model="obj:#ladle_model" material="color: #477725;" position="-1.09022 1.11093 -0.09321" rotation="-21.120943201907536 7.320681748386528 0" scale="" shadow="">
                </a-entity>
                <a-entity object-place id="ladle_placeholder" class="ladle_placeholder" obj-model="obj:#ladle_model" visible="false" material="color: red; opacity: 0.2;" position="-1.09022 1.11093 -0.09321" rotation="-21.120943201907536 7.320681748386528 0" scale="" shadow="">
                </a-entity>

                <a-entity object-pickup id="bowl" obj-model="obj:#bowl_model" material="color: #477725;" position="0.35389 1.53698 -1.20558" rotation="" scale="0.3 0.3 0.3" shadow="">
                </a-entity>
                <a-entity object-place id="bowl_placeholder" class="bowl_placeholder" obj-model="obj:#bowl_model" visible="false" material="color: red; opacity: 0.2;" position="-3.300 1.955 -5.835" rotation="" scale="0.3 0.3 0.3" shadow="">
                </a-entity>
    
            </a-entity>


            
            <!-- GROUND & SKY -->
            <a-plane static-body id="ground" position="0 0 5" width="30" height="30" rotation="-90 0 0" color="#a5a5a5" shadow></a-plane>
            
            <a-sky color="#ECECEC"></a-sky>
            <a-entity   id="sky"
                        geometry="primitive: sphere; radius: 1000"
                        material="shader: flat; src: #skymap; side: back"
                        loadscripts>
            </a-entity>

        </a-scene>
    </body>
</html>
