<!DOCTYPE html>

<html>
    <head>
        <title>Starting Environment</title>
         
        <script src="js/aframe-v0.8.2.min.js"></script>
		<script src="https://rawgit.com/Ctrl-Alt-Zen/aframe-mobile-controls/master/components/twoway-motion/twoway-motion.js"></script>
    	<script src="https://rawgit.com/Ctrl-Alt-Zen/aframe-mobile-controls/master/components/tilt-turn/tilt-turn.js"></script>
        <script src="https://rawgit.com/fernandojsg/aframe-teleport-controls/master/dist/aframe-teleport-controls.min.js"></script>
        <script src="js/master.js"></script>
        <script src="js/recipes.js"></script>
        <script src="js/trigger.js"></script>
        <script src="js/object-pickup.js"></script>
        <script src="js/object-place.js"></script>
        <script src="js/new-recipe.js"></script>
        <script src="js/detect-collision.js"></script>
        <script src="js/recipe-system.js"></script>
        <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.3.0/dist/aframe-physics-system.min.js"></script>

        <script>
            AFRAME.registerComponent('loadscripts', {
                init: function()
                {
                   // Add scripts to the 'scriptSrc' list below so they are loaded after the scene is created!
                    scriptSrc = ["js/deviceControls.js"];
                    var head= document.getElementsByTagName('head')[0];
                    for (var i = 0; i < scriptSrc.length; i++) {
                        newScript = document.createElement('script');
                        newScript.setAttribute('src', scriptSrc[i]);
                        head.appendChild(newScript);
                    };

                    //Playing background track
                    bgSound = document.querySelector('#ambiance');
                    bgSound.components['sound'].playSound();
                    bgMusic = document.querySelector('#music');
                    bgMusic.components['sound'].playSound();

                    customerBell = document.querySelector('#customerStation');
                    document.addEventListener('keydown', function(e) {
                        if(e.keyCode == 32) {
                            customerBell.components['sound'].stopSound();
                            customerBell.components['sound'].playSound();
                        }
                    });
                }
            });
        </script>

    </head>
    <body>
        <a-scene physics="restitution: 0.3; debug: true" recipe-system>
            
            <!-------------- TEXTURES ---------------->
            <a-assets>
                <img id="skymap" src="assets/textures/sunsetGradient.png" />
                <img id="area_texture" src="assets/textures/mainTexture.jpg" />

                <img id="Blank_Chit_texture" src="assets/textures/Blank_Chit.png" />
                <img id="Garlic_Chit_texture" src="assets/textures/Garlic_Chit.png" />
                <img id="Garlic_Chit_Completed_texture" src="assets/textures/Garlic_Chit_Completed.png" />
                <img id="Squash_Chit_texture" src="assets/textures/Squash_Chit.png" />
                <img id="Squash_Chit_Completed_texture" src="assets/textures/Squash_Chit_Completed.png" />
                <img id="Onion_Chit_texture" src="assets/textures/Onion_Chit.png" />
                <img id="Onion_Chit_Completed_texture" src="assets/textures/Onion_Chit_Completed.png" />

                <img crossorigin="anonymous" id="speechBubble1_map" src="assets/textures/speechBubble1_map.png">
                <img crossorigin="anonymous" id="speechBubble2_map" src="assets/textures/speechBubble2_map.png">
            </a-assets>

             <!-------------- SOUNDS ---------------->
             <a-assets>
                <a-asset-item crossorigin="anonymous" id="ambianceSrc" src="assets/sounds/stewIt_ambience.mp3" response-type="arraybuffer"></a-asset-item>
                <a-asset-item crossorigin="anonymous" id="musicSrc" src="assets/sounds/Whimsical-Popsicle.mp3" response-type="arraybuffer"></a-asset-item>
                <a-asset-item crossorigin="anonymous" id="customerBellSrc" src="assets/sounds/customer-bell.mp3" response-type="arraybuffer"></a-asset-item>
                <a-asset-item crossorigin="anonymous" id="customerGreetingSrc" src="assets/sounds/customer-hello.wav" response-type="arraybuffer"></a-asset-item>
                <a-asset-item crossorigin="anonymous" id="stewFillSrc" src="assets/sounds/stewFill.mp3" response-type="arraybuffer"></a-asset-item>
            </a-assets>
                
            <!---------------- MODELS ---------------->
            <a-assets>
                <a-asset-item id="area_model" src="assets/models/area.obj"></a-asset-item>

                <a-asset-item id="stewLiquid_model" src="assets/models/stewLiquid.obj"></a-asset-item>

                <a-asset-item id="squashWhole_model" src="assets/models/squash.obj"></a-asset-item>
                <a-asset-item id="squash_chop_1_model" src="assets/models/squash_chop_1.obj"></a-asset-item>
                <a-asset-item id="squash_chop_2_model" src="assets/models/squash_chop_2.obj"></a-asset-item>
                <a-asset-item id="squash_chop_3_model" src="assets/models/squash_chop_3.obj"></a-asset-item>
                <a-asset-item id="onionWhole_model" src="assets/models/onion.obj"></a-asset-item>
                <a-asset-item id="garlicWhole_model" src="assets/models/garlic.obj"></a-asset-item>
                <a-asset-item id="knife_model" src="assets/models/knife2.obj"></a-asset-item>
                <a-asset-item id="character_model" src="assets/models/character.obj"></a-asset-item>
                <a-asset-item id="ladle_model" src="assets/models/ladle.obj"></a-asset-item>
                <a-asset-item id="ladle_full_model" src="assets/models/ladle_full.obj"></a-asset-item>
                <a-asset-item id="bowl_model" src="assets/models/bowl.obj"></a-asset-item>
                <a-asset-item id="bowl_full_model" src="assets/models/bowl_full.obj"></a-asset-item>  

                <a-asset-item id="chit_model" src="assets/models/chit.obj"></a-asset-item>

                
                <a-asset-item id="interactableIngredient_model" src="assets/models/ingredient.obj"></a-asset-item>
                <a-asset-item id="fryingPan_model" src="assets/models/fryingPan.obj"></a-asset-item> 
                

                <!-- 
                <a-asset-item id="carrot_model" src="assets/models/carrot.obj"></a-asset-item>              
                <a-asset-item id="cuttingBoard_model" src="assets/models/cuttingBoard.obj"></a-asset-item>
                
               
                <a-asset-item id="mushroomWhole_model" src="assets/models/mushroom.obj"></a-asset-item>
                <a-asset-item id="potatoWhole_model" src="assets/models/potato.obj"></a-asset-item>
                <a-asset-item id="carrotWhole_model" src="assets/models/carrot.obj"></a-asset-item>                
                <a-asset-item id="celeryWhole_model" src="assets/models/celery.obj"></a-asset-item>                
                <a-asset-item id="cornWhole_model" src="assets/models/corn.obj"></a-asset-item>

                <a-asset-item id="lantern_model" src="assets/models/lantern.obj"></a-asset-item> -->


                <a-asset-item id="speechBubble_model" src="assets/models/speechBubble.obj"></a-asset-item>
            </a-assets>

            <!---------------- CAMERA ---------------->
           <a-entity id="cameraRig" position="0 1.9 3" rotation="0 180 0">
                <a-camera id="sceneCamera">
                    <a-entity id="cursor" cursor="rayOrigin: mouse" position="0 0 -1">
                    </a-entity>
                </a-camera>
            </a-entity>

    
            <!---------------- LIGHTING ---------------->
            <a-light type="ambient" color="white" position="35 5 0" intensity="0.6"></a-light>
            <a-light type="ambient" color="white" position="-0.15682 5.09305 0" intensity="0.4" light="type:point;color:#f7a83e"></a-light>


            <!---------------- A-FRAME ENTITIES ---------------->

            <a-entity id="area" obj-model="obj:#area_model" material="src: #area_texture" position="" rotation="" scale="" shadow=""></a-entity>

            <a-entity 
                id="stewLiquid" 
                obj-model="obj:#stewLiquid_model" 
                material="color:#F5E1A4" 
                position="0 -10 0" 
                rotation="" 
                scale="" 
                shadow=""
                sound="src: #stewFillSrc"
                >
            </a-entity>

            
            <!-- SOUNDS ENTITIES -->
             <a-entity id="music" sound="src:#musicSrc; volume: 0.02; loop: true; positional:false" ></a-entity>
            <a-entity id="ambiance" sound="src:#ambienceSrc; volume: 0.06; loop: true; positional:false"></a-entity>

            <!-- CUSTOMER SERVICE -->

            <a-entity 
                new-recipe="" 
                id="character1" 
                obj-model="obj:#character_model" 
                position="-9.59681 -0.01024 0.12693" 
                rotation="0 0.07620338675239949 0" 
                scale="" 
                shadow="" 
                sound="src: #customerGreetingSrc">
            </a-entity>
            
                <!-- speech bubble is loaded before the floor until it is displayed -->
            <a-entity id="speechBubble" obj-model="obj:#speechBubble_model" material="color:#ffffff" position="1.285 -2 -1.975" rotation="0 60.801 0" scale="1.2 1.2 1.2" shadow="">
            </a-entity>


            <!-- INGREDIENT STATION-->

            <a-entity 
                id="onion" 
                obj-model="obj:#onionWhole_model" 
                material="color:#c18747" 
                position="3.67323 1.97431 8.18909" 
                rotation="" 
                scale="" 
                shadow=""
                
                object-pickup="position:0.006 -0 -0.156; numPlaceholders: 2"
                detect-collision
                class="collidable" 
                >                
            </a-entity>
            
            <a-entity object-place="hasCollision: true" id="onion_placeholder" class="onion_placeholder collidable" obj-model="obj:#onionWhole_model" visible="false" material="color: red; opacity: 0.2;" position="7.5 3.2 -2.461"  rotation="0 0 0" scale="" shadow="cast:false">
            </a-entity> 

            <a-entity object-place="hasCollision: true" id="onion_placeholder2" class="onion_placeholder collidable" obj-model="obj:#onionWhole_model" visible="false" material="color: red; opacity: 0.2;" position="0.5 3 0"  rotation="0 0 0" scale="" shadow="cast:false">
            </a-entity>


            <a-entity 
                id="squash" 
                obj-model="obj:#squashWhole_model" 
                material="color:#CFBA5F" 
                position="4.30452 1.96926 7.3856" 
                rotation="" 
                scale="" 
                shadow=""
                
                object-pickup="position:0.006 -0 -0.156; numPlaceholders: 2"
                detect-collision="removeOnDrop: false; choppable: true; chopStates: #squash_chop_1_model, #squash_chop_2_model, #squash_chop_3_model"
                class="collidable" 
                > 
            </a-entity>

            <a-entity object-place="hasCollision: true" id="squash_placeholder" class="squash_placeholder collidable" obj-model="obj:#squashWhole_model" visible="false" material="color: red; opacity: 0.2;" position="7.5 2.5 -2.461"  rotation="0 0 0" scale="" shadow="cast:false">
            </a-entity> 

            <a-entity object-place="hasCollision: true" id="squash_placeholder2" class="squash_placeholder collidable" obj-model="obj:#squashWhole_model" visible="false" material="color: red; opacity: 0.2;" position="0 3.1 0"  rotation="0 0 0" scale="" shadow="cast:false">
            </a-entity>


            <a-entity 
                id="garlic" 
                obj-model="obj:assets/models/garlic.obj" 
                material="color:#CFBA5F" 
                position="4.91103 1.92973 6.55719" 
                rotation="" 
                scale="" 
                shadow=""

                object-pickup="position:0.006 -0 -0.156; numPlaceholders: 2"
                detect-collision
                class="collidable" 
                > 
            </a-entity>

            <a-entity object-place="hasCollision: true" id="garlic_placeholder" class="garlic_placeholder collidable" obj-model="obj:#garlicWhole_model" visible="false" material="color: red; opacity: 0.2;" position="7.5 3.5 -2.461"  rotation="0 0 0" scale="" shadow="cast:false">
            </a-entity> 

            <a-entity object-place="hasCollision: true" id="garlic_placeholder2" class="garlic_placeholder collidable" obj-model="obj:#garlicWhole_model" visible="false" material="color: red; opacity: 0.2;" position="-0.5 3.1 0"  rotation="0 0 0" scale="" shadow="cast:false">
            </a-entity>


            <!-- INGREDIENT STATION-->

            <!-- PREPERATION STATION-->

            <a-entity
                id="knife" 
                class="collidable" 
                object-pickup="position: 0.755 -0.871 -0.357; rotation: 40 20 90" 
                obj-model="obj:#knife_model" 
                material="color: #477725" 
                position="8.5 2 0" 
                rotation="0 0 0" 
                shadow=""
                
                body="type: static; shape:none;"

                shape__main="shape: box;
                halfExtents: 0.1 0.05 1;
                offset: 0 0 -0.8;">
            </a-entity>

            <a-entity
                id="cuttingBoard"
                geometry="primitive: box"  
                material="color: white" 
                position="7.451 2 -2.655" 
                rotation="0 -53.72 0"
                scale="2.13 0.1 1.31"
                shadow=""
                
                body="type: static; shape:none;"

                shape__main="shape: box;
                halfExtents: 0.5 0.5 0.5;
                offset: 0 0 0;">
            </a-entity>

            <a-entity object-place id="knife_placeholder" class="knife_placeholder" visible="false" obj-model="obj:#knife_model" material="color: red; opacity: 0.2;"  position="8.5 2 0" rotation="0 0 0" shadow="">
            </a-entity>

            <a-entity
                id="carrot"  
                obj-model="obj:#carrot_model" 
                detect-collision 
                position="-0.93936 1.39013 0.28187" 
                rotation="0 -112.6 0" 
                scale="0.3 0.3 0.3" 
                shadow=""

                body="type: dynamic; shape:none; linearDamping: 0.9; angularDamping: 0.9"
                
                shape__main="shape: box;
                halfExtents: 0.2 0.2 1.5;
                offset: 0 0.3 0.2;">
            </a-entity>


            <!-- COOKING AREA -->
                    
            <a-entity 
                id="fryingPan" 
                obj-model="obj:#fryingPan_model" 
                position="0.4 2.58 -8.3" 
                rotation="0 180 0" 
                scale="0.5 0.5 0.5" 
                shadow=""

                body="type: static; shape:none;"

                shape__main="shape: box;
                height: 0.1;
                halfExtents: 1 0.5 1;
                offset: 0 -0.5 0;">
            </a-entity>
           

            <!-- RECIPIE AREA -->
            <a-entity id="garlic_chit" obj-model="obj:#chit_model" material="src:#Blank_Chit_texture" position="-4.73258 3.07242 6.42619" rotation="0 57.41323586108415 0" scale="" shadow=""></a-entity>
            <a-entity id="squash_chit" obj-model="obj:#chit_model" material="src:#Blank_Chit_texture" position="-5.77195 3.14757 5.75577" rotation="0 57.44474853981633 0" scale="" shadow=""></a-entity>
            <a-entity id="onion_chit" obj-model="obj:#chit_model" material="src:#Blank_Chit_texture" position="-6.81907 3.13654 5.05183" rotation="0 56.32977267049176 0" scale="" shadow=""></a-entity>


            <!-- STEW AREA -->
            <a-entity 
                class="collidable" 
                object-pickup="position:0.826 -1.509 -0.711;rotation:-30 180 -8.6" 
                id="ladle" 
                detect-collision="colliders: stewPot, bowl; stewState: #ladle_full_model, #ladel_model"
                obj-model="obj:assets/models/ladle.obj" 
                material="color:#477725" 
                position="0.07973 1.91157 -0.51171" 
                rotation="-21.120943201907536 7.320681748386528 0"
                static-body 
                scale="" 
                shadow="" 
                raycaster="">
            </a-entity>
            <a-entity object-place id="ladle_placeholder" class="ladle_placeholder collidable" obj-model="obj:#ladle_model" visible="false" material="color: red; opacity: 0.2;" position="0.07973 1.91157 -0.51171" rotation="-21.120943201907536 7.320681748386528 0" scale="" shadow="">
            </a-entity>

            <a-entity 
                id="bowl" 
                class="collidable" 
                object-pickup="" 
                detect-collision="colliders: ladle; stewState: #bowl_full_model"
                obj-model="obj:assets/models/bowl.obj" 
                material="color:#477725" 
                position="6.81064 1.88921 -4.00935" 
                rotation="" scale="0.1 0.1 0.1"
                static-body 
                shadow="" 
                raycaster="">
            </a-entity>
            <a-entity object-place id="bowl_placeholder" class="bowl_placeholder collidable" obj-model="obj:#bowl_model" visible="false" material="color: red; opacity: 0.2;" position="6.81064 1.88921 -4.00935" rotation="" scale="0.1 0.1 0.1" shadow="">
            </a-entity>


            <a-entity 
                id="stewPot"
                obj-model="obj:#pot_model" 
                position="0 0 0" 
                rotation="0 90 0" 
                scale="0.8 0.8 0.8" 
                shadow=""

                body="type: static; shape:none;"

                shape__main="shape: cylinder;
                height: 4;
                radiusTop: 1.3;
                radiusBottom: 1.3;">
            </a-entity>

            <!-- GROUND & SKY -->
            <!-- <a-plane static-body id="ground" position="0 0 0" width="30" height="30" rotation="-90 0 0" color="#a5a5a5" shadow></a-plane> -->
            
            <a-sky color="#ECECEC" ></a-sky>
            <a-entity   id="sky"
                        rotation="0 180 0"
                        geometry="primitive: sphere; radius: 1000"
                        material="shader: flat; src: #skymap; side: back"
                        loadscripts>
            </a-entity>

        </a-scene>
    </body>
</html>


